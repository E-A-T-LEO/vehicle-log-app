(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{2383:()=>{},2936:(e,a,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return l(9287)}])},3686:()=>{},9287:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>g});var t=l(7876),s=l(4232),o=l(6042),r=l(9834),n=l(2964),d=l(1134),i=l(9580);l(7854);var m=l(1047),c=l(2945),u=l(2770);m.t1.register(m.PP,m.kc,m.E8,m.hE,m.m_,m.s$);let p=(0,o.Wp)({apiKey:"AIzaSyB4HL8EUbLrQx4tPehoZ5xDS7nv8jcUlNM",authDomain:"vehicle-log-app-9a199.firebaseapp.com",projectId:"vehicle-log-app-9a199",storageBucket:"vehicle-log-app-9a199.firebasestorage.app",messagingSenderId:"237686694452",appId:"1:237686694452:web:b6df2e8ff915ba1edfe061",measurementId:"G-BT5SPDXG5M"}),h=(0,r.xI)(p),x=(0,n.aU)(p),b=new r.HF,f={width:"100%",height:"400px"};function g(){let[e,a]=(0,s.useState)(null),[l,o]=(0,s.useState)([]),[m,p]=(0,s.useState)({date:"",from:"",to:"",purpose:"",fuel:"",toll:"",km:""}),[g,N]=(0,s.useState)(new Date),[j,k]=(0,s.useState)([]);(0,s.useEffect)(()=>{let e=(0,r.hg)(h,async e=>{if(a(e),e){let a=(0,n.P)((0,n.rJ)(x,"logs"),(0,n._M)("uid","==",e.uid));o((await (0,n.GG)(a)).docs.map(e=>e.data()))}else o([])});return()=>e()},[]),(0,s.useEffect)(()=>{let e=g.toISOString().split("T")[0],a=l.filter(a=>a.date===e),t=e=>{let a=e.split("").reduce((e,a)=>e+a.charCodeAt(0),0);return{lat:35+a%10*.01,lng:128+a%10*.01}},s=[];for(let e of a)s.push(t(e.from)),s.push(t(e.to));k(s)},[g,l]);let v=e=>{p({...m,[e.target.name]:e.target.value})},C=async()=>{if(e&&m.date&&m.from&&m.to){let a={...m,uid:e.uid};await (0,n.gS)((0,n.rJ)(x,"logs"),a),o([...l,a]),p({date:"",from:"",to:"",purpose:"",fuel:"",toll:"",km:""})}},D=async()=>{await (0,r.df)(h,b)},y=async()=>{await (0,r.CI)(h)},_=l.reduce((e,a)=>e+Number(a.km||0),0),w=l.reduce((e,a)=>e+Number(a.fuel||0),0),S=l.reduce((e,a)=>e+Number(a.toll||0),0),E=l.reduce((e,a)=>{let l=(a.date||"").slice(0,7);return e[l]||(e[l]={km:0,fuel:0,toll:0}),e[l].km+=Number(a.km||0),e[l].fuel+=Number(a.fuel||0),e[l].toll+=Number(a.toll||0),e},{}),I={labels:Object.keys(E),datasets:[{label:"주행거리 (km)",data:Object.values(E).map(e=>e.km),backgroundColor:"#3B82F6"},{label:"유류비 (원)",data:Object.values(E).map(e=>e.fuel),backgroundColor:"#10B981"},{label:"통행료 (원)",data:Object.values(E).map(e=>e.toll),backgroundColor:"#F59E0B"}]},O=g.toISOString().split("T")[0],A=g.toISOString().slice(0,7),P=l.filter(e=>e.date===O).reduce((e,a)=>e+Number(a.km||0),0);return(0,t.jsxs)("div",{className:"p-4 max-w-5xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h1",{className:"text-xl font-bold",children:"차량 운행일지"}),e?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm",children:e.displayName}),(0,t.jsx)("button",{onClick:y,className:"bg-red-500 text-white px-2 py-1 rounded text-sm",children:"로그아웃"})]}):(0,t.jsx)("button",{onClick:D,className:"bg-blue-500 text-white px-3 py-1 rounded",children:"Google 로그인"})]}),e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,t.jsx)("input",{name:"date",placeholder:"날짜 (예: 2025-05-14)",value:m.date,onChange:v,className:"border p-2"}),(0,t.jsx)("input",{name:"from",placeholder:"출발지",value:m.from,onChange:v,className:"border p-2"}),(0,t.jsx)("input",{name:"to",placeholder:"도착지",value:m.to,onChange:v,className:"border p-2"}),(0,t.jsx)("input",{name:"purpose",placeholder:"운행 목적",value:m.purpose,onChange:v,className:"border p-2"}),(0,t.jsx)("input",{name:"fuel",placeholder:"유류비 (원)",value:m.fuel,onChange:v,className:"border p-2"}),(0,t.jsx)("input",{name:"toll",placeholder:"통행료 (원)",value:m.toll,onChange:v,className:"border p-2"}),(0,t.jsx)("input",{name:"km",placeholder:"주행거리 (km)",value:m.km,onChange:v,className:"border p-2"})]}),(0,t.jsx)("button",{onClick:C,className:"bg-green-600 text-white px-4 py-2 rounded",children:"기록 추가"})]}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("h2",{className:"font-semibold mb-2",children:"\uD83D\uDCCB 운행기록"}),l.map((e,a)=>(0,t.jsxs)("div",{className:"border p-2 text-sm mb-2",children:[e.date," | ",e.from," → ",e.to," | ",e.purpose," | \uD83D\uDE97 ",e.km,"km | ⛽ ",e.fuel,"원 | \uD83D\uDEE3 ",e.toll,"원"]},a)),(0,t.jsxs)("div",{className:"mt-4 text-sm font-semibold",children:["총 주행거리: ",_,"km / 총 유류비: ",w,"원 / 총 통행료: ",S,"원"]})]}),(0,t.jsxs)("div",{className:"mt-10",children:[(0,t.jsx)("h2",{className:"font-semibold mb-2",children:"\uD83D\uDCCA 월별 통계 차트"}),(0,t.jsx)(d.yP,{data:I,options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"월별 운행 통계"}}}})]}),(0,t.jsxs)("div",{className:"mt-10",children:[(0,t.jsx)("h2",{className:"font-semibold mb-2",children:"\uD83D\uDCC5 일별 주행거리 보기"}),(0,t.jsx)(i.Ay,{onChange:N,value:g}),(0,t.jsxs)("div",{className:"mt-2 text-sm font-semibold",children:["선택한 날짜: ",O," / 주행거리: ",P,"km"]})]}),(0,t.jsxs)("div",{className:"mt-10",children:[(0,t.jsx)("h2",{className:"font-semibold mb-2",children:"\uD83D\uDDFA️ 이동 경로 보기"}),(0,t.jsx)(c.aJ,{googleMapsApiKey:"AIzaSyAyKZUPUo1JQfay_Mm6XQMzpSrglLzA4O4",children:(0,t.jsx)(c.u6,{mapContainerStyle:f,center:{lat:35.8,lng:128.6},zoom:9,children:(0,t.jsx)(c.Ro,{path:j,options:{strokeColor:"#3B82F6",strokeOpacity:.8,strokeWeight:4}})})})]}),(0,t.jsx)("div",{className:"mt-10",children:(0,t.jsx)("button",{onClick:()=>{let e=u.Wp.book_new(),a=[["날짜","출발지","도착지","운행 목적","유류비","통행료","주행거리"]];l.filter(e=>(e.date||"").startsWith(A)).forEach(e=>{a.push([e.date,e.from,e.to,e.purpose,e.fuel,e.toll,e.km])});let t=u.Wp.aoa_to_sheet(a);u.Wp.book_append_sheet(e,t,"운행기록"),u._h(e,"vehicle_log_".concat(A,".xlsx"))},className:"bg-yellow-500 text-white px-4 py-2 rounded",children:"\uD83D\uDCE4 엑셀로 내보내기"})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[509,697,759,671,733,890,636,593,792],()=>a(2936)),_N_E=e.O()}]);